<!DOCTYPE html>
<html lang="en">
<head>
    <title>Seda Alerts</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel='stylesheet' href='css/mainPage.css' type='text/css' />
    <script type="text/javascript" src="js/sedaValidation.js"></script>
    <script type="text/javascript" src="js/rsValidation.js"></script>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.js"></script>

    <script type="text/javascript">

         jQuery(document).ready(function() {
            checkContainer();
        });

        function checkContainer () {
             if($('#div-sedaAlertsForm').is(':visible')){
                    loadSedaAlertEnvironments();
            }else if($('#div-RecordServicesForm').is(':visible')){
                   loadRSEnvironments();
             }else {
                 setTimeout(checkContainer, 50);
             }
         }

        function hideSedaPassword() {
          $('#sedaPasswordDiv').hide();
        };
         function loadSedaAlertEnvironments() {
            $("#env").load("http://localhost:9080/getAlertSedaEnvironments", function(responseTxt, statusTxt, xhr){
              if(statusTxt == "success")
                  showHideSedaPasswordTxtBox();
                // console.log(responseTxt);
              if(statusTxt == "error")
                alert("Error while loading environments: " + xhr.status + ": " + xhr.statusText);
                showHideSedaPasswordTxtBox();
             });

         }
         function loadRSEnvironments() {
            var  task= document.getElementById("task").value;
            $("#recordServiceEnv").load("http://localhost:9080/getRSEnvironments", {task: task}, function(responseTxt, statusTxt, xhr){
              if(statusTxt == "success")
                 showHidePasswordRSTxtBox();
                 showHideSnapShotTxt();
              //   console.log(responseTxt);
              if(statusTxt == "error")
                alert("Error while loading RSEnvironments: " + xhr.status + ": " + xhr.statusText);
                showHidePasswordRSTxtBox();
                 showHideSnapShotTxt();
             });

         }


        $( function() {
            $( "#logicalDate" ).datepicker(
            {
                dateFormat: 'yy-mm-dd',
                maxDate: -1
             });

        } );

        function showHideSedaPasswordTxtBox(){
          var selectedEnv = $('#env option:selected').val();
                   if(selectedEnv =='prod-edc' || selectedEnv =='prod-eagan') {
                    $('#sedaPasswordDiv').show();
                  }else{
                       $('#sedaPasswordDiv').hide();
                  }
        }
       function showHideFormDivs(){
       var  appName=  document.getElementById("appName").value;
       //alert(appName);
       if( appName== 'sedaAlerts'){
             $("#div-sedaAlertsForm").show();
             $("#div-RecordServicesForm").hide();
             loadSedaAlertEnvironments();
       }else if (appName== 'recordServices'){
            $("#div-RecordServicesForm").show();
            $("#div-sedaAlertsForm").hide();
            loadRSEnvironments();
       }else{
             $("#div-RecordServicesForm").hide();
             $("#div-sedaAlertsForm").hide();
       }

    }

    function showHideSnapShotTxt(){
         var  task=  document.getElementById("task").value;
         if(task == 'health' || task == 'extract'){
            $("#snapshotDiv").hide();
         }else{
             $("#snapshotDiv").show();
         }
    }
    function showHidePasswordRSTxtBox(){
          var selectedEnv = $('#recordServiceEnv option:selected').text();
          // alert("show pass" +selectedEnv.startsWith('Prod'));
                   if(selectedEnv.startsWith('Prod')) {
                    $('#rsPasswordDiv').show();
                  }else{
                       $('#rsPasswordDiv').hide();
                  }
        }

    </script>
 </head>
<body>
<div id="div-cortellis-utility-tool-form">
    <div class="form-sub-title" align="center">Cortellis Utility Tool</div>
    <form name="cortellis-utility-tool-form" >
        <table align="center"  border="0">
            <tr>
                <td nowrap="true">
                    <label>Application: </label>&nbsp;</td><td><div class="input-container" id="appNameDiv">
                <select name="appName" id="appName" onchange="showHideFormDivs();">
                        <option value="--">--</option>
                        <option value="sedaAlerts">cortellis-seda-alerts</option>
                        <option value="recordServices">record-services</option>
                </select></div>
            </td>
            </tr>
        </table>
    </form>

</div>
<div id="div-sedaAlertsForm" hidden="true">
    <div class="form-sub-title" align="center">Cortellis Seda Alerts Utility</div>
    <form name="sedaAlertsForm" action="/sendAlerts"  onsubmit="return validateSedaAlertsForm()"  method="post">
        <table align="center"  border="0">
            <tr>
                <td nowrap="true">
                    <label>Environment: </label>&nbsp;</td><td><div class="input-container" id="envDiv">
                <select name="env" id="env" onchange="showHideSedaPasswordTxtBox();" required>
                <!-- <option value="local">Local-Machine</option>
                    <option value="dev-dtc">Dev-DTC</option>
                    <option value="build-dtc">Build-DTC</option>
                    <option value="qa-eagan">QA-EAGAN</option>
                    <option value="prod-edc">Prod-EDC</option>
                    <option value="prod-eagan">Prod-EAGAN</option>-->
                </select></div>
            </td>
            </tr>


            <tr>
                <td nowrap="true"><label for="logicalDate">Logical Date:</label>&nbsp;</td>
                <td><div class="input-container"><div class="tooltip"><input type="text" id="logicalDate" name="logicalDate" readonly="true" style="width:85px;" placeholder="YYYY-DD-MM"><span class="tooltiptext">Alerts will be process for this Date</span></div></div></td>
            </tr>
            <tr>
                <td><label>Alert Id(s):</label></td>
                <td>
                    <textarea rows="4" cols="50" name="alertIds" id="alertIds"  placeholder="Please separate Alert ID(s) using a comma (,) "  onkeyup="javascript:disableAllUsersCheckBox();"></textarea>
                </td>
            </tr>
            <tr>
                <td>&nbsp;</td><div class="input-container">
                <td nowrap="true"><input type="checkbox" name="chkAllAlerts" id="chkAllAlerts" onclick="javascript:disableAlertIdsTextArea();">&nbsp;&nbsp;all users(internal+external)</td></div>
            </tr>

            <tr id="sedaPasswordDiv">
                <td nowrap="true"><label for="sedaPassword">Password :</label>&nbsp;</td>
                <td><input type="password" id="sedaPassword" name="password"  style="width:85px;"></td>
            </tr>

        </table>
        <div style="text-align:center">
            <input class="greenButton" type="submit" id="sedaSubmit" value="Submit" />
            <input class="greenButton" type="reset" id="sedaClear" value="Clear" onclick="javascript:eraseText();"/>
        </div>
    </form>
    <div id="error">&nbsp;</div>
</div>
<div id="div-RecordServicesForm" hidden="true">
  <div class="form-sub-title" align="center">Cortellis Record Services utility Tool</div>
  <form name="recordServicesForm" id="recordServicesForm" action="/recordServiceAction"  onsubmit="return validateRecordServicesForm()"  method="post">
      <table align="center"  border="0">
          <tr>
              <td nowrap="true"><label>component: </label>&nbsp;</td>
              <td nowrap="true"><div class="input-container" id="componentDiv">
                  <select name="componentName" id="componentName" required>
                      <option value="Drugv1">Drug</option>
                      <option value="Trialv1">Trial</option>
                      <option value="Companyv1">Company</option>
                      <option value="PatentFamilyv1">Patent Family</option>
                  </select></div>
              </td>
          </tr>
          <tr>
              <td nowrap="true"><label>Task: </label>&nbsp;</td>
              <td nowrap="true"><div class="input-container" id="task-container">
                  <select name="task" id="task" onchange="showHideSnapShotTxt();loadRSEnvironments();" required>
                      <option value="extract">Extract</option>
                      <option value="load">Load</option>
                      <option value="publish">Publish</option>
                      <option value="health">Health</option>
                  </select></div>
              </td>
          </tr>
          <tr>
              <td nowrap="true">
                  <label>Environment: </label>&nbsp;</td><td><div class="input-container" id="env-container-rs">
              <select name="recordServiceEnv" id="recordServiceEnv" onchange="showHidePasswordRSTxtBox();" required>
                    <!--  <option value="local">Local-Machine</option>
                      <option value="c427nvzdnganp.int.thomsonreuters.com">Dev-DTC-MW-B-1</option>
                      <option value="c343ravdnganp.int.thomsonreuters.com">Build-DTC-MW-B-1</option>
                      <option value="c898hhwenganp.int.thomsonreuters.com">QA-EAGAN-MW-B-1</option>
                      <option value="c514jgnenganp.int.thomsonreuters.com">QA-EAGAN-MW-B-2</option>
                      <option value="c475rxkenganp.int.thomsonreuters.com">Perf-EAGAN-MW-B-1</option>
                      <option value="c484bpxenganp.int.thomsonreuters.com">Perf-EAGAN-MW-B-2</option>
                      <option value="c624mkrlngapr.int.thomsonreuters.com">Prod-EDC-MW-B-1</option>
                      <option value="c447tdxlngapr.int.thomsonreuters.com">Prod-EDC-MW-B-2</option>
                      <option value="c129uwfengapr.int.thomsonreuters.com">Prod-EAGAN-MW-B-1</option>
                      <option value="c019cjqengapr.int.thomsonreuters.com">Prod-EAGAN-MW-B-2</option>-->
              </select></div>
          </td>
          </tr>
          <tr id="snapshotDiv">
              <td nowrap="true"><label for="snapshotTime">snapshot Time:</label>&nbsp;</td>
              <td><div class="input-container"><div class="tooltip"><input type="text" id="snapshotTime" name="snapshotTime"  style="width:160px;" placeholder="YYYY-MM-DDTHH:MM:SSZ"   max="24"  min="22"></div></div></td>
          </tr>
          <tr id="rsPasswordDiv">
              <td nowrap="true"><label for="rsPassword">Password :</label>&nbsp;</td>
              <td><input type="password" id="rsPassword" name="rsPassword"  style="width:85px;" ></td>
          </tr>
      </table>
      <div style="text-align:center">
          <input class="greenButton" type="submit" id="submitRecordServicesForm" value="Submit" />
          <input class="greenButton" type="reset" id="clearRecordServicesForm" value="Clear" />
      </div>

  </form>
</div>
</body>
</html>

